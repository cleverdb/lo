<import src="../template/pageAlert/pageAlert.wxml" />
<template is="PageAlert" data="{{...pageState}}" />
<view class='container' wx:if='{{!pageState.state}}'>
  <scroll-view scroll-y="true" class="course-list">
    <block wx:for="{{courseList}}" wx:key="index">
      <view class="course">
         <view class="course-hd {{item.iconUrl ? '' : 'empty'}}">
                    <image  wx:if='{{item.iconUrl}}' mode='scaleToFill' src="{{host}}{{item.iconUrl}}"></image>
        </view>
        <view class="course-bd">
          <view class='hd'>
            <view class='lt'>
              <view class="cell name">{{item.courseName}}</view>
              <view class="cell">{{item.coachName}}</view>
              <view class="cell">{{item.courseType}} / {{item.strength}}</view>
            </view>
            <view class='rt'>
              <button bindtap='loadPlanTap' data-id ="{{item.courseId}}" data-item ="{{item}}" >预约</button>
            </view>
          </view>
          <view class='bd'>
            <view class="line"></view>
            <view class="cell">{{item.stores}}</view>
          </view>
        </view>
        <view class='course-ft'>
          <!-- <view class='detail' bindtap='showModal'>
            预约
          </view> -->
          <!-- <navigator url="/pages/curoseDetail/curoseDetail" class="detail">预约</navigator>  -->
        </view>
      </view>
    </block>
  </scroll-view>
  <view class="popup-container" bindtap="hideModal" wx:if="{{showModalStatus}}"></view>
  <view animation="{{animationData}}" class="popup-content" wx:if="{{showModalStatus}}">
    <view class="popup-content-hd">
      <view class="tr">
        <view class="td name">预约门店</view>
        <view class="td content">
          <picker value="{{dateIndex}}" range='{{stores}}' bindchange="bindStoreChange">
            <view class="picker">
              {{selectStore}}
            </view>
          </picker>
          <view class="arrow"></view>
        </view>
      </view>
      <view class="tr">
        <view class="td name">预约日期</view>
        <view class="td content">
          <picker value="{{dateIndex}}" range='{{pickerDates}}' bindchange="bindDateChange">
            <view class="picker">
              {{selectDate}}
            </view>
          </picker>
          <view class="arrow"></view>
        </view>
      </view>
      <view class='tr no-border'>
        <view class='td name'>上课时间</view>
        <view class='td content time'>
          <block wx:for="{{times}}" wx:key="{{index}}">
            <view class="time {{selectPlanId==item.coursePlanId?'selected':''}}" data-id="{{item.coursePlanId}}" data-item ="{{item}}" bindtap='timeTap'>{{item.startTime}}-{{item.endTime}}</view>
          </block>
        </view>
      </view>
    </view>
    <cover-view class='join-activity' bindtap='appointmentTap'>
      <cover-view>立即预约</cover-view>
    </cover-view>
  </view>
  
  <view class="alert" hidden='{{hideAlert}}'>
      <view class='alert-hd'>
        <view>
          请确认预约信息
        </view>
      </view>
      <view class='alert-bd'>
        <view class="alert-bd_cell">
           <view class='point'></view>
           <view>{{selectCourse.courseName}}</view>
        </view>
        <view class="alert-bd_cell">
           <view class='point'></view>
           <view>{{selectCourse.coachName}}</view>
        </view>
        <view class="alert-bd_cell">
          <view class='point'></view>
          <view>{{selectStore}}</view>
        </view>
        <view class="alert-bd_cell">
          <view class='point'></view>
          <view>{{selectPlan.courseDate}} {{selectPlan.startTime}}-{{selectPlan.endTime}}</view>
        </view>
      </view>
      <view class='alert-ft' bindtap='confirmAppointment' >
      确定
      </view>
    <view class="del" bindtap='closeAlert'><image mode='scaleToFill' src="/images/icon/del.png"></image></view>
    </view>
</view>